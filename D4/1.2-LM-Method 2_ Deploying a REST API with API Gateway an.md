<img src="https://r2cdn.perplexity.ai/pplx-full-logo-primary-dark%402x.png" style="height:64px;margin-right:32px"/>

## Method 2: Deploying a REST API with API Gateway and Lambda Using AWS CLI

For DevOps engineers preferring *infrastructure as code* or automation, here’s how to set up the same API using the AWS CLI. This gives you fully scriptable and repeatable deployments.

***

### **Step 1: Set Shell Variables**

Set variables for easy reference:

```bash
REGION=us-east-1
API_NAME="MyRestApiCLI"
LAMBDA_NAME="MyApiLambdaFunction"
ROLE_ARN="arn:aws:iam::<YOUR_ACCOUNT_ID>:role/lambda-apigateway-role"
```

Replace `<YOUR_ACCOUNT_ID>` with your AWS account ID.

***

### **Step 2: Create Lambda Function (If Not Created)**

Assume you have a Python handler in `lambda_function.py` packed as `lambda.zip`:

```bash
aws lambda create-function \
  --function-name $LAMBDA_NAME \
  --runtime python3.13 \
  --handler lambda_function.lambda_handler \
  --zip-file fileb://lambda.zip \
  --role $ROLE_ARN \
  --region $REGION
```


***

### **Step 3: Create REST API in API Gateway**

```bash
API_ID=$(aws apigateway create-rest-api \
  --name "$API_NAME" \
  --region $REGION \
  --query 'id' \
  --output text)
```


***

### **Step 4: Get Root Resource ID**

```bash
PARENT_ID=$(aws apigateway get-resources \
  --rest-api-id $API_ID \
  --region $REGION \
  --query 'items[^0].id' \
  --output text)
```


***

### **Step 5: Create Resource (`/items`)**

```bash
RESOURCE_ID=$(aws apigateway create-resource \
  --rest-api-id $API_ID \
  --region $REGION \
  --parent-id $PARENT_ID \
  --path-part items \
  --query 'id' \
  --output text)
```


***

### **Step 6: Create Method (e.g., POST)**

```bash
aws apigateway put-method \
  --rest-api-id $API_ID \
  --resource-id $RESOURCE_ID \
  --http-method POST \
  --authorization-type NONE \
  --region $REGION
```


***

### **Step 7: Integrate POST Method with Lambda**

Get the Lambda ARN:

```bash
LAMBDA_ARN=$(aws lambda get-function --function-name $LAMBDA_NAME --region $REGION --query 'Configuration.FunctionArn' --output text)
```

Add Lambda permission to allow API Gateway invocation:

```bash
aws lambda add-permission \
  --function-name $LAMBDA_NAME \
  --region $REGION \
  --statement-id apigateway-access \
  --action lambda:InvokeFunction \
  --principal apigateway.amazonaws.com \
  --source-arn "arn:aws:execute-api:$REGION:<YOUR_ACCOUNT_ID>:$API_ID/*/POST/items"
```

Create integration:

```bash
aws apigateway put-integration \
  --rest-api-id $API_ID \
  --region $REGION \
  --resource-id $RESOURCE_ID \
  --http-method POST \
  --type AWS_PROXY \
  --integration-http-method POST \
  --uri arn:aws:apigateway:$REGION:lambda:path/2015-03-31/functions/$LAMBDA_ARN/invocations
```


***

### **Step 8: Deploy the API**

```bash
aws apigateway create-deployment \
  --rest-api-id $API_ID \
  --stage-name dev \
  --region $REGION
```


***

### **Step 9: Test the API**

The endpoint will be:

```
https://$API_ID.execute-api.$REGION.amazonaws.com/dev/items
```

Test with curl:

```bash
curl -X POST "https://$API_ID.execute-api.$REGION.amazonaws.com/dev/items"
```


***

### **References**

- Official AWS CLI documentation for [API Gateway](https://docs.aws.amazon.com/cli/latest/reference/apigateway/) and [Lambda integration](https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-lambda-proxy-integration-using-cli.html).[^2][^7][^8]
- For more customization, such as query string/headers or adding CORS, review the [AWS CLI API Gateway guide].[^4][^7][^2]

***

## **Summary**

- GUI method is great for learning and quick prototyping.
- AWS CLI lets you automate and document your setup, making it reproducible and version-controllable—critical for DevOps workflows.

If you need a ready-to-run Bash script or want to extend with more endpoints (GET, PUT, DELETE), let me know!

<div style="text-align: center">⁂</div>

[^1]: https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-create-api-as-simple-proxy-for-lambda.html

[^2]: https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-lambda-proxy-integration-using-cli.html

[^3]: https://docs.aws.amazon.com/lambda/latest/dg/services-apigateway-tutorial.html

[^4]: https://docs.aws.amazon.com/cli/latest/reference/apigateway/

[^5]: https://jeromedecoster.github.io/aws/api-gateway--lambda--aws-cli/

[^6]: https://www.youtube.com/watch?v=4NY8nst45Rk

[^7]: https://docs.aws.amazon.com/cli/latest/reference/apigateway/create-rest-api.html

[^8]: https://docs.aws.amazon.com/apigateway/latest/developerguide/api-gateway-create-api-cli-sdk.html

[^9]: https://dev.to/aws-builders/create-and-deploy-stages-of-a-rest-api-using-api-gateway-and-lambda-with-serverless-3n4a

